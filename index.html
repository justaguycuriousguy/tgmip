<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vaporwave Meme Maker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --neon-pink: #ff71ce;
            --neon-blue: #01cdfe;
            --neon-purple: #b967ff;
            --neon-green: #05ffa1;
            --dark-bg: #1a1a2e;
            --modal-bg: rgba(26, 26, 46, 0.95);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: "Segoe UI", sans-serif; margin: 0; padding: 16px; background-color: var(--dark-bg); color: white; }
        .canvas-container { position: relative; width: 100%; max-width: 600px; margin: auto; }
        #memeCanvas { width: 100%; border: 2px solid var(--neon-blue); border-radius: 12px; }
        .control-panel { display: flex; justify-content: space-around; margin-top: 16px; }
        .button { background: var(--neon-purple); color: white; padding: 8px 12px; border: none; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="canvas-container">
        <canvas id="memeCanvas" width="800" height="600"></canvas>
    </div>
    
    <div class="control-panel">
        <input type="file" id="fileInput" accept="image/*" style="display: none;">
        <button class="button" onclick="document.getElementById('fileInput').click()">Choose Image</button>
        <button class="button" onclick="addOverlay()">Add Overlay</button>
        <button class="button" onclick="saveMeme()">Save Image</button>
    </div>

<script>
    const canvas = document.getElementById('memeCanvas');
    const ctx = canvas.getContext('2d');
    let baseImage = new Image();
    let overlays = [];
    let activeOverlay = null;

    // Upload background image
    document.getElementById('fileInput').addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (event) => {
                baseImage.src = event.target.result;
                baseImage.onload = () => {
                    drawCanvas();
                };
            };
            reader.readAsDataURL(file);
        }
    });

    // Draw all elements on canvas
    function drawCanvas() {
        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Draw background image
        if (baseImage.src) {
            ctx.drawImage(baseImage, 0, 0, canvas.width, canvas.height);
        }

        // Draw overlays
        overlays.forEach(overlay => {
            ctx.save();
            ctx.translate(overlay.x, overlay.y);
            ctx.rotate((overlay.rotation * Math.PI) / 180);
            ctx.scale(overlay.scale, overlay.scale);
            ctx.drawImage(overlay.image, -overlay.image.width / 2, -overlay.image.height / 2);
            ctx.restore();
        });
    }

    // Add a new overlay
    function addOverlay() {
        const overlayImage = new Image();
        overlayImage.src = 'https://via.placeholder.com/150'; // Placeholder image; replace with desired image source
        overlayImage.onload = () => {
            const overlay = {
                image: overlayImage,
                x: canvas.width / 2,
                y: canvas.height / 2,
                rotation: 0,
                scale: 1,
            };
            overlays.push(overlay);
            activeOverlay = overlay;
            drawCanvas();
        };
    }

    // Save meme as an image
    function saveMeme() {
        const link = document.createElement('a');
        link.download = 'meme.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    }

    // Event listeners for drag, rotation, scaling of active overlay
    canvas.addEventListener('mousedown', startDrag);
    canvas.addEventListener('mousemove', drag);
    canvas.addEventListener('mouseup', endDrag);

    let isDragging = false;
    let startX, startY;

    function startDrag(e) {
        const [mouseX, mouseY] = getMousePos(e);
        activeOverlay = overlays.find(overlay => isOverlayClicked(overlay, mouseX, mouseY));
        if (activeOverlay) {
            isDragging = true;
            startX = mouseX - activeOverlay.x;
            startY = mouseY - activeOverlay.y;
        }
    }

    function drag(e) {
        if (!isDragging || !activeOverlay) return;
        const [mouseX, mouseY] = getMousePos(e);
        activeOverlay.x = mouseX - startX;
        activeOverlay.y = mouseY - startY;
        drawCanvas();
    }

    function endDrag() {
        isDragging = false;
    }

    function getMousePos(e) {
        const rect = canvas.getBoundingClientRect();
        return [e.clientX - rect.left, e.clientY - rect.top];
    }

    function isOverlayClicked(overlay, x, y) {
        const dx = x - overlay.x;
        const dy = y - overlay.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        return dist < overlay.image.width / 2 * overlay.scale;
    }

    // Transformations
    document.addEventListener('keydown', (e) => {
        if (!activeOverlay) return;
        if (e.key === 'ArrowUp') activeOverlay.scale += 0.05;
        if (e.key === 'ArrowDown') activeOverlay.scale = Math.max(0.1, activeOverlay.scale - 0.05);
        if (e.key === 'ArrowLeft') activeOverlay.rotation -= 5;
        if (e.key === 'ArrowRight') activeOverlay.rotation += 5;
        drawCanvas();
    });
</script>
</body>
</html>


